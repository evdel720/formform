{"version":3,"sources":["webpack/bootstrap 30a76b5c6a7cb8d8de61","./public/lib/game_view.js","./public/lib/utils.js","./public/lib/solo_mode.js","./public/lib/game.js","./public/lib/board.js","./public/lib/piece.js","./public/lib/piece_array.js","./public/lib/timer.js","./public/lib/multi_mode.js"],"names":["document","addEventListener","options","board","getElementById","pieces","rotate","flip","instruction","timer","levels","main","mode","wonSound","lostSound","placeSound","roomSet","roomLink","opponent","boardNode","pageURL","decodeURIComponent","window","location","search","substring","param","split","roomId","socket","emit","on","message","alert","history","replaceState","origin","gameMode","solo","enableUI","multi","game","clearBoard","classList","add","mainBtnHandler","Array","from","children","forEach","li","idx","e","btn","preventDefault","pickedPiece","movePickedPiece","id","copyTarget","target","dataset","copytarget","querySelector","select","execCommand","setLevelHandler","isPlaying","remove","pieceNum","reset","getGridNode","gridNode","map","row","findLoc","cell","i","length","j","disableInteraction","isWin","mainText","play","innerText","changeToGray","querySelectorAll","piece","style","cursor","setAttribute","resetUIShow","query","backgroundColor","placePieceOnBoard","pieceNode","pCell","bCell","pieceObject","bLoc","pLoc","topLeft","isValid","placePiece","boardChangeHandler","isWon","dropHandler","parentNode","contains","dropHelper","pickedCell","pieceMap","get","won","wonHandler","SoloMode","disabled","stop","start","colors","Game","$boardNode","$pieces","multiData","color","undefined","shuffledOrder","firstP","pieceSets","innerHTML","removeAttribute","generatePieceMap","generateRandomPieces","renderBoard","el","removePiece","bind","v","k","appendChild","res","colorIdx","Math","floor","random","p","push","action","renderPiece","node","currentPiece","ul","createElement","pieceSet","Map","pieceOb","pieceClickHandler","set","neighbors","Board","piecesObjects","values","generateBoard","cellMap","every","placed","loc","console","log","t","join","placeHelper","pos","put","callback","delete","result","randomIdx","shuffledPieces","pop","piecesArr","movePieceAt","getBestPieceAndPosition","bestPos","bestPiece","len","n","sharedBorder","possibleIndexes","current","newBorder","Piece","randomPiece","sound","arr","temp","last","Timer","$timer","init","seconds","interval","timeout","renderTimer","fontSize","clearInterval","clearTimeout","setTimeout","setInterval","tick","MultiMode","ready","initialUI","setLink","setUpDisconnect","setUpNewGame","setUpOpponentBoard","lostHandler","opponentBoard","data","link","value"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/lib/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 30a76b5c6a7cb8d8de61","import { getGridNode, dropHandler, setLevelHandler } from './utils.js';\n\nimport SoloMode from './solo_mode.js';\nimport MultiMode from './multi_mode.js';\n/* global socket */\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  let options = {\n    board: document.getElementById('board'),\n    pieces: document.getElementById('pieces'),\n    rotate: document.getElementById('rotate'),\n    flip: document.getElementById('flip'),\n    instruction: document.getElementById('instruction'),\n    timer: document.getElementById('timer'),\n    levels: document.getElementById('levels'),\n    main: document.getElementById('main'),\n    mode: document.getElementById('mode'),\n    wonSound: document.getElementById('won-sound'),\n    lostSound: document.getElementById('lost-sound'),\n    placeSound: document.getElementById('place-sound'),\n    roomSet: document.getElementById('room-set'),\n    roomLink: document.getElementById('room-link'),\n    opponent: document.getElementById('opponent-board')\n  };\n\n  options.boardNode = getGridNode(options.board);\n\n  let pageURL = decodeURIComponent(window.location.search.substring(1));\n  let param = pageURL.split('=');\n  let roomId;\n  if (param[0] === 'room_id') {\n    roomId = param[1];\n    socket.emit('joinRoom', roomId);\n    socket.on('failure', (message) => {\n      window.alert(message);\n      window.history.replaceState({}, '', window.location.origin);\n      gameMode = solo;\n      gameMode.enableUI();\n    });\n  }\n\n  let multi = new MultiMode(options);\n  let solo = new SoloMode(options);\n\n  let gameMode = roomId ? multi : solo;\n  gameMode.enableUI();\n  options.mode.addEventListener('click', () => {\n    if (gameMode.game) { gameMode.game.clearBoard(); }\n    if (gameMode.mode === 'solo') {\n      gameMode = multi;\n      socket.emit('newRoom');\n    } else {\n      socket.emit('changeMode');\n      gameMode = solo;\n    }\n    gameMode.enableUI();\n  });\n\n  options.main.addEventListener('click', () => {\n    options.instruction.classList.add(\"hidden\");\n    gameMode.mainBtnHandler();\n  });\n\n  Array.from(options.levels.children).forEach((li, idx) => {\n    setLevelHandler(gameMode, li, idx);\n  });\n\n  document.addEventListener('drop', (e) => {\n    dropHandler(gameMode, e);\n  });\n\n  [options.rotate, options.flip].forEach((btn) => {\n    btn.addEventListener('click', (e) => {\n      e.preventDefault();\n      if (gameMode.game && gameMode.game.pickedPiece) {\n        gameMode.game.movePickedPiece(btn.id);\n      }\n    });\n  });\n\n  document.getElementById('copy').addEventListener('click', (e) => {\n    let copyTarget = e.target.dataset.copytarget;\n    copyTarget = document.querySelector(copyTarget);\n    copyTarget.select();\n    document.execCommand('copy');\n  });\n\n  document.addEventListener('dragover', (e) => {\n    e.preventDefault();\n  }, false);\n});\n\n\n\n// WEBPACK FOOTER //\n// ./public/lib/game_view.js","\nconst setLevelHandler = (gameMode, li, idx) => {\n  li.addEventListener('click', () => {\n    if (gameMode.mode === 'solo' && !gameMode.game.isPlaying) {\n      document.querySelector('li.selected-level').classList.remove('selected-level');\n      li.classList.add('selected-level');\n      gameMode.game.pieceNum = idx + 4;\n      gameMode.timer.reset((idx + 1) * 60);\n    }\n  });\n};\n\nconst getGridNode = (gridNode) => {\n  return Array.from(gridNode.children).map((row) => Array.from(row.children));\n};\n\nconst findLoc = (boardNode, cell) => {\n  for (let i=0; i<boardNode.length; i++) {\n    for (let j=0; j<boardNode[0].length; j++) {\n      if (boardNode[i][j] === cell) {\n        return [i, j];\n      }\n    }\n  }\n};\n\nconst disableInteraction = (game, isWin, gameMode, mainText) => {\n  if (!isWin) {\n    gameMode.options.lostSound.play();\n  }\n  gameMode.options.main.innerText = mainText;\n  game.isPlaying = false;\n  if (game.pickedPiece) {\n    game.pickedPiece.classList.remove('picked');\n  }\n\n  changeToGray('#board li.filled', isWin);\n  changeToGray('#pieces li.filled');\n  gameMode.options.rotate.classList.add('hidden');\n  gameMode.options.flip.classList.add('hidden');\n  gameMode.options.mode.classList.remove('hidden');\n\n  document.querySelectorAll('#pieces > *').forEach((piece) => {\n    piece.style.cursor = \"default\";\n    piece.setAttribute('draggable', false);\n  });\n  gameMode.resetUIShow();\n};\n\nconst changeToGray = (query, isWin) => {\n  document.querySelectorAll(query).forEach((cell) => {\n      if (!isWin) {\n        cell.style.backgroundColor = \"#AAA\";\n      }\n      cell.style.cursor = \"default\";\n  });\n};\n\nconst placePieceOnBoard = (pieceNode, pCell, boardNode, bCell, board, pieceObject, gameMode) => {\n  let bLoc = findLoc(boardNode, bCell);\n  let pLoc = findLoc(getGridNode(pieceNode), pCell);\n  let topLeft = [bLoc[0] - pLoc[0], bLoc[1] - pLoc[1]];\n  if (board.isValid(pieceObject, topLeft)) {\n    board.placePiece(pieceNode, topLeft);\n    if (gameMode.mode === 'multi') {\n      gameMode.boardChangeHandler();\n    }\n    if (board.isWon()) {\n      gameMode.options.wonSound.play();\n      return true;\n    } else {\n      gameMode.options.placeSound.play();\n    }\n  }\n};\n\nconst dropHandler = (gameMode, e) => {\n  e.preventDefault();\n  let game = gameMode.game;\n  if (game && e.target.parentNode.classList &&\n      e.target.parentNode.classList.contains(\"dropzone\") &&\n      game.isPlaying) {\n    dropHelper(e.target, gameMode);\n  }\n};\n\nconst dropHelper = (bCell, gameMode) => {\n  let game = gameMode.game;\n  let pCell = game.pickedCell;\n  if (pCell) {\n    let pieceNode = pCell.parentNode.parentNode;\n    let pieceObject = game.pieceMap.get(pieceNode);\n    let won = placePieceOnBoard(pieceNode, pCell,\n      gameMode.options.boardNode, bCell,\n      game.board, pieceObject, gameMode);\n    if (won) { gameMode.wonHandler(); }\n  }\n};\n\nexport { setLevelHandler, getGridNode, findLoc,\n        disableInteraction, dropHandler,\n        placePieceOnBoard };\n\n\n\n// WEBPACK FOOTER //\n// ./public/lib/utils.js","import Game from './game.js';\nimport Timer from './timer.js';\nimport { setLevelHandler, disableInteraction,\n         placePieceOnBoard } from './utils.js';\n\nclass SoloMode {\n  constructor(options) {\n    this.mode = 'solo';\n    this.options = options;\n    this.game = new Game(options.boardNode, options.pieces);\n    this.timer = new Timer(this.options.timer, disableInteraction, this);\n  }\n\n  enableUI() {\n    this.game.clearBoard();\n    window.history.replaceState({}, '', window.location.origin);\n    this.options.rotate.classList.add('hidden');\n    this.options.flip.classList.add('hidden');\n    this.options.main.classList.remove(\"ready\");\n    this.options.mode.innerText = \"Battle\";\n    this.options.main.disabled = false;\n    this.options.main.innerText = \"Play\";\n    this.options.levels.classList.remove(\"hidden\");\n    this.options.roomSet.classList.add('hidden');\n  }\n\n  mainBtnHandler() {\n    if (this.game.isPlaying) {\n      this.game.clearBoard();\n      this.timer.stop();\n      disableInteraction(this.game, false, this, 'Play');\n    } else {\n      this.options.rotate.classList.remove(\"hidden\");\n      this.options.flip.classList.remove(\"hidden\");\n      this.options.main.innerText = 'Quit';\n      this.options.timer.classList.remove(\"hidden\");\n      this.options.mode.classList.add(\"hidden\");\n      this.options.levels.classList.add(\"hidden\");\n      this.timer.start(this.game);\n      this.game.play();\n    }\n  }\n\n  resetUIShow() {\n    this.options.timer.classList.add('hidden');\n    this.options.levels.classList.remove('hidden');\n  }\n\n  wonHandler() {\n    this.options.wonSound.play();\n    this.timer.stop();\n    disableInteraction(this.game, true, this, 'Play');\n  }\n}\n\nexport default SoloMode;\n\n\n\n// WEBPACK FOOTER //\n// ./public/lib/solo_mode.js","import Board from './board.js';\nimport Piece from './piece.js';\n\nconst colors = ['rgb(162, 72, 151)', 'rgb(238, 89, 139)', 'rgb(126, 205, 199)', 'rgb(34, 193, 228)', 'rgb(45, 49, 108)', 'rgb(246, 180, 205)', 'rgb(245, 143, 51)', 'rgb(226, 35, 63)', 'rgb(250, 235, 62)', 'rgb(189, 214, 93)', 'rgb(241, 122, 128)'];\n\nclass Game {\n  constructor($boardNode, $pieces, multiData, gameMode) {\n    this.multiData = multiData || {\n      color: undefined,\n      pieces: [],\n      shuffledOrder: [],\n      firstP: undefined,\n      pieceNum: undefined\n    };\n    this.$boardNode = $boardNode;\n    this.$pieces = $pieces;\n    this.pieceNum = this.multiData.pieceNum || 4;\n    this.pieceSets = undefined;\n    this.board = undefined;\n    this.pieceMap = undefined;\n    this.pickedPiece = undefined;\n    this.pickedCell = undefined;\n    this.isPlaying = false;\n    this.gameMode = gameMode;\n  }\n\n  clearBoard() {\n    this.$pieces.innerHTML = \"\";\n    this.$boardNode.forEach((row) => {\n      row.forEach((cell) => {\n        cell.removeAttribute('style');\n        cell.classList.remove('filled');\n      });\n    });\n    this.pickedPiece = undefined;\n  }\n\n  play() {\n    // reset all the status and start\n    this.clearBoard();\n    this.isPlaying = true;\n    this.generatePieceMap(this.generateRandomPieces());\n    this.board = new Board(this.pieceMap, this.$boardNode, this.multiData, this.gameMode);\n    this.renderBoard();\n  }\n\n  renderBoard() {\n    for (let i=0; i<this.board.board.length; i++) {\n      for (let j=0; j<this.board.board[0].length; j++) {\n        let el = this.$boardNode[i][j];\n        if (this.board.board[i][j] === 1) {\n          el.addEventListener('click', this.board.removePiece.bind(this));\n        }\n        el.setAttribute('class', this.board.board[i][j] === 1 ? 'filled' : \"\");\n      }\n    }\n    this.pieceMap.forEach((v, k) => {\n      this.$pieces.appendChild(k);\n    });\n  }\n\n  generateRandomPieces() {\n    let res = [];\n    let colorIdx = this.multiData.color || Math.floor(Math.random() * colors.length);\n    for (let i=0; i<this.pieceNum; i++) {\n      let p = new Piece(this.multiData.pieces[i]);\n      p.color = colors[(colorIdx + i) % colors.length];\n      res.push(p);\n    }\n    return res;\n  }\n\n  movePickedPiece(action) {\n    let pieceObject = this.pieceMap.get(this.pickedPiece);\n    if (action === \"flip\") {\n      pieceObject.flip();\n    } else {\n      pieceObject.rotate();\n    }\n    this.renderPiece(this.pickedPiece, pieceObject);\n  }\n\n  renderPiece(node, piece) {\n    node.innerHTML = \"\";\n    piece.currentPiece().forEach((row) => {\n      let ul = document.createElement('ul');\n      row.forEach((el) => {\n        let li = document.createElement('li');\n        li.addEventListener('mousedown', (e) => {\n          this.pickedCell = e.target;\n        });\n        li.addEventListener('mouseup', (e) => {\n          this.pickedCell = undefined;\n        });\n        if (el === 1) {\n          li.classList.add(\"filled\");\n          li.style.backgroundColor = piece.color;\n        }\n        ul.appendChild(li);\n      });\n      node.appendChild(ul);\n    });\n  }\n\n  generatePieceMap(pieceSet) {\n    this.pieceMap = new Map();\n    pieceSet.forEach((pieceOb) => {\n      let pieceNode = document.createElement('div');\n      pieceNode.classList.add('piece');\n      pieceNode.setAttribute('draggable', true);\n      this.renderPiece(pieceNode, pieceOb);\n      pieceNode.addEventListener('click', this.pieceClickHandler.bind(this, pieceNode));\n      this.pieceMap.set(pieceNode, pieceOb);\n    });\n  }\n\n  pieceClickHandler(pieceNode, e) {\n    e.preventDefault();\n    if (this.isPlaying === false) { return; }\n    if (this.pickedPiece === pieceNode) {\n      pieceNode.classList.remove('picked');\n      this.pickedPiece = undefined;\n    } else {\n      if (this.pickedPiece) {\n        this.pickedPiece.classList.remove('picked');\n      }\n      pieceNode.classList.add('picked');\n      this.pickedPiece = pieceNode;\n    }\n  }\n}\n\nexport default Game;\n\n\n\n// WEBPACK FOOTER //\n// ./public/lib/game.js","const neighbors = [[-1, 0], [1, 0], [0, -1], [0, 1]];\n\nclass Board {\n  constructor(pieceMap, $boardNode, multiData, gameMode) {\n    this.multiData = multiData;\n    this.piecesObjects = Array.from(pieceMap.values());\n    this.pieceMap = pieceMap;\n    this.$boardNode = $boardNode;\n    this.board = this.generateBoard();\n    this.cellMap = new Map();\n    this.gameMode = gameMode;\n  }\n\n  isWon() {\n    return this.piecesObjects.every((p) => p.placed);\n  }\n\n  isValid(pieceOb, loc) {\n    // returns true if the piece can be placed on the location\n    // for testing, logging stuff\n    if (pieceOb.placed || loc[0] < 0 || loc[1] < 0) {\n      console.log(\"piece already placed or location is smaller than 0\");\n      return false;\n    }\n    let piece = pieceOb.currentPiece();\n    for (let i=0; i<piece.length; i++) {\n      for (let j=0; j<piece[0].length; j++) {\n        if (piece[i][j] === 1 && this.board[i+loc[0]][j+loc[1]] !== 1) {\n          // These are for testing!\n          console.log(`piece location: ${i}, ${j}`);\n          console.log(`board location: ${i+loc[0]}, ${j+loc[1]}`);\n          console.log(\"piece:\");\n          piece.forEach((row, t) => {\n            console.log(`${t} ${row.join(\" \")}`);\n          });\n          console.log(\"board:\");\n          this.board.forEach((row, t) => {\n            console.log(`${t} ${row.join(\" \")}`);\n          });\n          window.board = this.board;\n          return false;\n        }\n      }\n    }\n    return true;\n  }\n\n  placePiece(pieceNode, loc) {\n    let pieceOb = this.pieceMap.get(pieceNode);\n    let piece = pieceOb.currentPiece();\n    for (let i=0; i<piece.length; i++) {\n      for (let j=0; j<piece[0].length; j++) {\n        if (piece[i][j] === 1) {\n          this.placeHelper([i+loc[0], j+loc[1]], pieceNode, pieceOb);\n        }\n      }\n    }\n    if (this.gameMode) {\n      this.gameMode.boardChangeHandler();\n    }\n    pieceNode.classList.add(\"hidden\");\n    pieceOb.placed = true;\n  }\n\n  placeHelper(loc, pieceNode, pieceOb) {\n    this.board[loc[0]][loc[1]] = 2;\n    this.$boardNode[loc[0]][loc[1]].style.backgroundColor = pieceOb.color;\n    this.cellMap.set(this.$boardNode[loc[0]][loc[1]], pieceNode);\n    this.$boardNode[loc[0]][loc[1]].classList.add(\"placed-cell\");\n    this.$boardNode[loc[0]][loc[1]].style.cursor = \"pointer\";\n  }\n\n  movePieceAt(pos, board, piece, put, callback) {\n    // put is boolean. if it's true, place piece\n    // if it's false, remove piece from the pos\n    for (let i=0; i<piece.length; i++) {\n      for (let j=0; j<piece[0].length; j++) {\n        if (piece[i][j] === 1) {\n          if (put) {\n            board[i+pos[0]][j+pos[1]]++;\n          } else {\n            board[i+pos[0]][j+pos[1]]--;\n          }\n        }\n      }\n    }\n  }\n\n  removePiece(e) {\n    if (this.isPlaying && e.target.classList.contains(\"placed-cell\")) {\n      let pieceNode = this.board.cellMap.get(e.target);\n      pieceNode.classList.remove(\"hidden\");\n      this.pieceMap.get(pieceNode).placed = false;\n      this.board.$boardNode.forEach((row, i) => {\n        row.forEach((cell, j) => {\n          if (this.board.cellMap.get(cell) === pieceNode) {\n            cell.setAttribute(\"style\", \"\");\n            cell.classList.remove(\"placed-cell\");\n            this.board.board[i][j] = 1;\n            this.board.cellMap.delete(cell);\n          }\n        });\n      });\n      if (this.gameMode) {\n        this.gameMode.boardChangeHandler();\n      }\n    }\n  }\n\n  shuffledPieces() {\n    // shuffles the pieces\n    const result = this.piecesObjects.map((p) => p);\n    for (let i=0; i<result.length; i++) {\n      let randomIdx = this.multiData.shuffledOrder[i];\n      if (randomIdx === undefined) {\n        randomIdx = Math.floor(Math.random() * result.length);\n      }\n      let j =  randomIdx;\n      [result[i], result[j]] = [result[j], result[i]];\n    }\n    return result;\n  }\n\n  generateBoard() {\n    let shuffledPieces = this.shuffledPieces();\n    let board = this.$boardNode.map((row) => row.map((cell) => 0));\n    let randomIdx = this.multiData.firstP === undefined ? Math.floor(Math.random() * 8) : this.multiData.firstP;\n    let firstP = shuffledPieces.pop().piecesArr[randomIdx];\n    // start at the middle\n    let i = Math.floor((board.length - firstP.length) / 2);\n    let j = Math.floor((board[0].length - firstP[0].length) / 2);\n    this.movePieceAt([i, j], board, firstP, true);\n\n    shuffledPieces.forEach((p) => {\n      let [bestPos, bestPiece] = this.getBestPieceAndPosition(board, p);\n      this.movePieceAt(bestPos, board, bestPiece, true);\n    });\n    return board;\n  }\n\n  sharedBorder(pos, board, piece) {\n    let len = 0;\n    for (let i=0; i<piece.length; i++) {\n      for (let j=0; j<piece[0].length; j++) {\n        if (piece[i][j] === 1) {\n          if (board[i+pos[0]][j+pos[1]] === 1) { return -1; }\n          neighbors.forEach((n) => {\n            if (board[n[0]+i+pos[0]] !== undefined && board[n[0]+i+pos[0]][n[1]+j+pos[1]] === 1) {\n              len++;\n            }\n          });\n        }\n      }\n    }\n    return len;\n  }\n\n  getBestPieceAndPosition(board, piece) {\n    // get the best possible position by running through\n    // all possible combination\n    let sharedBorder = -1;\n    let bestPos = [];\n    let bestPiece = [];\n    piece.possibleIndexes.forEach((idx) => {\n      let current = piece.piecesArr[idx];\n      for (let i=0; i<board.length - current.length; i++) {\n        for (let j=0; j<board[0].length - current[0].length; j++) {\n          let newBorder = this.sharedBorder([i, j], board, current);\n          if (newBorder > sharedBorder) {\n            sharedBorder = newBorder;\n            bestPos = [i, j];\n            bestPiece = current;\n          }\n        }\n      }\n    });\n    return [bestPos, bestPiece];\n  }\n}\n\nexport default Board;\n\n\n\n// WEBPACK FOOTER //\n// ./public/lib/board.js","import pieces from './piece_array.js';\n// prepopulate all the pieces in piece_array.js\n\n\nclass Piece {\n  constructor(idx) {\n    let randomPiece = pieces[Math.floor(Math.random() * pieces.length)];\n    if (idx !== undefined) {\n      randomPiece = pieces[idx];\n    }\n    this.piecesArr = randomPiece.piecesArr;\n    this.possibleIndexes = randomPiece.possibleIndexes;\n    this.idx = 0;\n    this.placed = false;\n    this.sound = document.getElementById('move-sound');\n  }\n\n  currentPiece() {\n    return this.piecesArr[this.idx];\n  }\n\n  rotate() {\n    this.sound.play();\n    if (this.idx < 4) {\n      this.idx = (this.idx + 1) % 4;\n    } else {\n      this.idx = (this.idx + 1) % 8 || 4;\n    }\n  }\n\n  flip() {\n    this.sound.play();\n    this.idx = (this.idx + 4) % 8;\n  }\n}\n\nexport default Piece;\n\n\n\n// WEBPACK FOOTER //\n// ./public/lib/piece.js","const rotate = (arr) => {\n  let res = [];\n  for (let j=0; j<arr[0].length; j++) {\n    let temp = [];\n    for (let i=arr.length - 1; i>=0; i--) {\n      temp.push(arr[i][j]);\n    }\n    res.push(temp);\n  }\n  return res;\n};\n\nconst flip = (arr) => {\n  let res = [];\n  arr.forEach((row) => {\n    let temp = [];\n    for (let i=row.length - 1; i>=0; i--) {\n      temp.push(row[i]);\n    }\n    res.push(temp);\n  });\n  return res;\n};\n// in 12 pieces, 5 pieces shares same shape in rotation\n// 1 piece has same for all\n// [...[piece arr], [indexs of things that doesn't change]]\n// in 0 to 7 indexs\nconst pieces = [\n  [[1, 1, 1], [0, 1, 0], -1],\n  [[1, 1], [1, 1], [0]],\n  [[1, 1, 1], [0, 1]],\n  [[1, 1], [0, 1]],\n  [[1, 1, 1, 1], [0, 1]],\n  [[1, 1], [1, 0], -1],\n  [[1, 1, 1], [1, 1, 0], -1],\n  [[1, 1, 1], [1, 0, 0], -1],\n  [[1, 0, 0], [1, 1, 1], [0, 0, 1], [0, 1, 4, 5]],\n  [[1, 1, 1, 1], [0, 1, 0, 0], -1],\n  [[1, 1, 0], [0, 1, 1], [0, 1, 4, 5]],\n  [[1, 1, 1, 1], [1, 0, 0, 0], -1]\n];\n\nexport default pieces.map((p, idx) => {\n  const piece = {};\n  const last = p.pop();\n  piece.possibleIndexes = last === -1 ? [0, 1, 2, 3, 4, 5, 6, 7] : last;\n  piece.piecesArr = [p];\n  for (let i=0; i<3; i++) {\n    piece.piecesArr.push(rotate(piece.piecesArr[i]));\n  }\n  for (let i=0; i<4; i++) {\n    piece.piecesArr.push(flip(piece.piecesArr[i]));\n  }\n  return piece;\n});\n\n\n\n// WEBPACK FOOTER //\n// ./public/lib/piece_array.js","class Timer {\n  constructor($timer, callback, gameMode) {\n    this.$timer = $timer;\n    this.init = 60;\n    this.seconds = this.init;\n    this.interval = undefined;\n    this.timeout = undefined;\n    this.callback = callback;\n    this.gameMode = gameMode;\n    this.renderTimer();\n  }\n\n  renderTimer() {\n    if (this.seconds === 10) {\n      this.$timer.style.color = \"#F00\";\n      this.$timer.style.fontSize = \"45px\";\n    }\n    this.$timer.innerText = this.seconds;\n  }\n\n  reset(seconds) {\n    this.init = seconds;\n    this.seconds = seconds;\n    this.renderTimer();\n  }\n\n  tick() {\n    this.seconds--;\n    this.renderTimer();\n    if (this.seconds === 0) {\n      this.stop();\n    }\n  }\n\n  stop() {\n    window.clearInterval(this.interval);\n    window.clearTimeout(this.timeout);\n    this.seconds = this.init;\n  }\n\n  start(game) {\n    this.$timer.style.color = '#000';\n    this.$timer.style.fontSize = \"30px\";\n    if (game.isPlaying) {\n      this.stop();\n    }\n    this.renderTimer();\n    this.timeout = window.setTimeout(() =>  this.callback(game, false, this.gameMode, 'Play'), this.init * 1000);\n    this.interval = window.setInterval(this.tick.bind(this), 1000);\n  }\n}\n\nexport default Timer;\n\n\n\n// WEBPACK FOOTER //\n// ./public/lib/timer.js","import Game from './game.js';\nimport { placePieceOnBoard } from './utils.js';\n/* global socket */\n\nclass MultiMode {\n  constructor(options) {\n    this.mode = 'multi';\n    this.options = options;\n    this.ready = false;\n    this.game = undefined;\n  }\n\n  enableUI() {\n    this.options.timer.classList.add('hidden');\n    this.options.levels.classList.add('hidden');\n    this.options.mode.innerText = \"Solo\";\n    this.initialUI();\n    this.setLink();\n    socket.on(\"matchSuccess\", () => {\n      this.options.roomSet.classList.add('hidden');\n      this.options.opponent.classList.remove('hidden');\n      this.options.main.disabled = false;\n      this.setUpDisconnect();\n      this.setUpNewGame();\n      this.setUpOpponentBoard();\n      this.lostHandler();\n    });\n  }\n\n  setUpOpponentBoard() {\n    socket.on(\"sendBoardData\", data => {\n      this.opponentBoard = data;\n      // update board!\n    });\n  }\n\n  initialUI() {\n    this.options.main.innerText = 'Ready';\n    this.options.roomSet.classList.remove('hidden');\n    this.options.opponent.classList.add('hidden');\n    this.options.rotate.classList.add('hidden');\n    this.options.flip.classList.add('hidden');\n    this.options.main.disabled = true;\n    this.opponentBoard = undefined;\n  }\n\n  setUpNewGame() {\n    socket.on(\"newGame\", (data) => {\n      this.options.main.classList.remove('ready');\n      this.options.main.innerText = 'Quit';\n      this.options.rotate.classList.remove(\"hidden\");\n      this.options.flip.classList.remove(\"hidden\");\n      this.game = new Game(this.options.boardNode, this.options.pieces, data, this);\n      this.game.play();\n    });\n  }\n\n  setUpDisconnect() {\n    socket.on(\"opponentDisconnected\", () => {\n      window.alert(\"Your opponent is disconnected.\");\n      this.initialUI();\n      this.mainBtnHandler();\n      if (this.game) {\n        this.game.clearBoard();\n        this.game = undefined;\n      }\n    });\n  }\n\n  setLink() {\n    socket.on(\"setLink\", (roomId) => {\n      let link = window.location.origin + \"?room_id=\" + roomId;\n      window.history.replaceState({}, '', link);\n      this.options.roomLink.value = link;\n    });\n  }\n\n  mainBtnHandler() {\n    if (this.ready) {\n      socket.emit('cancelReady');\n      this.options.main.classList.remove(\"ready\");\n    } else {\n      socket.emit('ready');\n      this.options.main.classList.add(\"ready\");\n    }\n    this.ready = !this.ready;\n  }\n\n  boardChangeHandler() {\n    socket.emit('boardChanged', this.game.board.board);\n  }\n\n  lostHandler() {\n    socket.on('lost', () => {\n      console.log('lost');\n      this.options.lostSound.play();\n    });\n  }\n\n  wonHandler() {\n    // emit winning\n    // disable interaction for both of winning, losing\n    console.log('won');\n    socket.emit('won');\n  }\n}\n\nexport default MultiMode;\n\n\n\n// WEBPACK FOOTER //\n// ./public/lib/multi_mode.js"],"sourceRoot":""}